[supervisord]
nodaemon=true
logfile=/app/logs/supervisord.log
pidfile=/tmp/supervisord.pid
loglevel=info

[program:xvfb]
command=/usr/bin/Xvfb :99 -screen 0 %(ENV_DISPLAY_WIDTH)sx%(ENV_DISPLAY_HEIGHT)sx24 -ac +extension GLX +render -noreset
autostart=true
autorestart=true
priority=10
stdout_logfile=/app/logs/xvfb-stdout.log
stderr_logfile=/app/logs/xvfb-stderr.log

[program:fluxbox]
command=/usr/bin/fluxbox -display :99
autostart=true
autorestart=true
priority=15
environment=DISPLAY=:99
stdout_logfile=/app/logs/fluxbox-stdout.log
stderr_logfile=/app/logs/fluxbox-stderr.log

[program:x11vnc]
command=/usr/bin/x11vnc -display :99 -forever -shared -rfbport %(ENV_VNC_PORT)s -nopw -xkb -ncache 10 -ncache_cr
autostart=true
autorestart=true
priority=20
environment=DISPLAY=:99
stdout_logfile=/app/logs/x11vnc-stdout.log
stderr_logfile=/app/logs/x11vnc-stderr.log

[program:novnc]
command=/usr/bin/websockify --web=/usr/share/novnc %(ENV_NOVNC_PORT)s localhost:%(ENV_VNC_PORT)s
autostart=true
autorestart=true
priority=25
stdout_logfile=/app/logs/novnc-stdout.log
stderr_logfile=/app/logs/novnc-stderr.log

[program:scrapers]
command=python main.py
directory=/app
autostart=true
autorestart=true
priority=30
environment=DISPLAY=:99,PYTHONUNBUFFERED=1,PYTHONPATH=/app
stdout_logfile=/app/logs/scrapers-stdout.log
stderr_logfile=/app/logs/scrapers-stderr.log
